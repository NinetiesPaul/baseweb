<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta charset="UTF8">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">        
        <link href="includes/css/glyphicons.css" rel="stylesheet">
        <link href="includes/css/navbar.css" rel="stylesheet">
        <link href="includes/css/datatables.css" rel="stylesheet">
        <script src="includes/js/jquery.js"></script>
        <script>          

        $(document).on('click', '.delete', function(){
            let id = this.getAttribute('userId');
            
            $.ajax({
                url: "user",
                data: { id: id },
                type: "DELETE",
                success: function(response){
                    if (response.success) {
                        $('.row_' + id).fadeOut(400, function(){
                            remove();
                        });
                    }
                }
            });
        });
        
        /*$(document).ready( function () {
            $('#tableAlunos').DataTable({
                "paging": true,
                "language": {
                    "url": "https://cdn.datatables.net/plug-ins/1.10.20/i18n/Portuguese-Brasil.json"
                }
            });
        });*/
        
        </script>
        <title>BaseApp :: Users</title>
    </head>
    <body>
        <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
            <a class="navbar-brand" href="/home">BaseApp</a>
            <div class="collapse navbar-collapse" id="navbarsExampleDefault">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Logged as {{ loggedAs }}
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="/home">Home</a>
                            <a class="dropdown-item" href="/logout">Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="container">
            <div class="jumbotron text-center">
                <p><strong>Showing all users</strong></p>

                <table style="margin-left: auto; margin-right: auto; font-size: 13; width: auto !important;" class="table hover" id="tableAlunos">
                    <thead>
                        <tr><td style="width: 75%;"><b>Name</b></td><td><b>Details</b></td><td><b>Delete</b></td></tr>
                    </thead>
                    <tbody>
                        {% for user in users %}
                            <tr class="row_{{user.id}}">
                                <td>{{ user.name }}</td>
                                <td style="text-align: center;"><a href='/user/{{user.id}}'><span class='glyphicon glyphicon-eye-open'></span> </a></td>
                                <td style="text-align: center;"><a href='#' class='delete' userId="{{user.id}}"><span class='glyphicon glyphicon-remove'></span> </a></td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>
        <script type="application/json" charset="utf8" src="https://cdn.datatables.net/plug-ins/1.10.20/i18n/Portuguese-Brasil.json"></script>
    </body>
</html>
